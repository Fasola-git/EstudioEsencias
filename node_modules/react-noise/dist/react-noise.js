import{jsx as t,jsxs as e}from"react/jsx-runtime";import{useRef as n,useSyncExternalStore as i,useLayoutEffect as r,forwardRef as o,useEffect as a}from"react";function c(){return c=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},c.apply(this,arguments)}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var u={renderNoise:y,setConfig:g,initFinished:{default:!1},caches:[],init:m,configs:{default:{opacity:.1,color:"75 75 75",resolution:{width:1080,height:1080}}}},s=[],d=function(t){return s=[].concat(s,[t]),function(){s=s.filter(function(e){return e!==t})}},h=function(){return u},f=function(){return u},v=function(){for(var t,e=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}(t))){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(s);!(t=e()).done;)(0,t.value)()};function g(t,e){var n,i,r;void 0===e&&(e="default");var o=(u.configs[e]||{}).resolution;t.resolution&&o&&(null==(n=t.resolution)?void 0:n.width)!==o.width&&(null==(i=t.resolution)?void 0:i.height)!==o.height&&(u.caches[e]=null),(u=c({},u,{configs:c({},u.configs,(r={},r[e]=c({resolution:{width:1920,height:1080}},u.configs[e],t),r))})).initFinished[e]=!1,m(e),v()}function m(t){if(void 0===t&&(t="default"),u.initFinished[t])return null;var e=u.configs[t],n=e.resolution||{},i=u.caches[t]||function(t,e,n){void 0===t&&(t=1080),void 0===e&&(e=1080);var i=document.createElement("canvas");return i.setAttribute("width",""+t),i.setAttribute("height",""+e),u.caches[n]=i,i}(n.width,n.height,t);!function(t,e,n){void 0===n&&(n=!1);var i=t.canvas,r=t.createImageData(i.width,i.height),o=r.data.length;t.imageSmoothingEnabled=!0;for(var a=e.opacity,c=e.color,l=(null==c?void 0:c.split(" "))||["255","255","255"],u=l[0],s=l[1],d=l[2],h=0;h<o;h+=4){var f=Math.random();r.data[h]=f<.5?parseInt(u):1,r.data[h+1]=f<.5?parseInt(s):1,r.data[h+2]=f<.5?parseInt(d):1,r.data[h+3]=f<.5?255*a|0:0}if(t.putImageData(r,0,0),n)try{return i.toDataURL()}catch(t){return console.error(t),null}}(i.getContext("2d"),e),u.initFinished[t]=!0}function y(t,e){void 0===e&&(e="default");var n=u.configs[e];if(!t||!n)return null;var i=t.getBoundingClientRect(),r=i.width,o=i.height,a=n.resolution;return null==t||t.getContext("2d").clearRect(0,0,r,o),t.setAttribute("width",a.width+"px"),t.setAttribute("height",a.height+"px"),t.style.minWidth=""+a.width,t.style.minHeight=""+a.height,t.getContext("2d").drawImage(u.caches[e],0,0),function(){null==t||t.getContext("2d").clearRect(0,0,r,o)}}var p=o(function(o,a){var c=o.children,l=o.className,u=void 0===l?"":l,s=o.noiseKey,v=o.isAnimated,g=void 0!==v&&v,p=o.style,b=void 0===p?{}:p,w=o.opacity,A=void 0===w?1:w,x=function(t){var e=n(null),o=i(d,h,f),a=o.configs,c=o.initFinished;return r(function(){if(a[t]){m(t);var n=y(e.current,t);return function(){null==n||n()}}},[a[t],t]),[e,!c[t]]}(void 0===s?"default":s);return t("div",{className:u,ref:a,children:e("div",{style:b,"data-noise":"container","data-noise-anim":g,className:"_lz5XT",children:[t("canvas",{ref:x[0],"data-noise":"canvas",className:"_FgVMr",style:{"--opacity":A}}),t("div",{"data-noise":"children",className:"_cbJPb",children:c})]})})}),b=function(t,e){void 0===e&&(e=[]),a(function(){null==g||g(t,t.key)},e)},w=o(function(e,n){var i=e.style;return t("div",{className:"_meFOG "+e.className,style:void 0===i?{}:i,ref:n,children:e.children})});export{p as Noise,w as NoiseContent,b as useNoiseConfig};
